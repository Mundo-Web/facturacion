var T=Object.defineProperty;var G=(c,r,n)=>r in c?T(c,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):c[r]=n;var j=(c,r,n)=>(G(c,typeof r!="symbol"?r+"":r,n),n);import{A as H,i as y}from"./Adminto-CmE1rFjT.js";import{R as e,a as O,C as z,c as L,r as a}from"./CreateReactScript-fryF6WsV.js";import{B as U}from"./BasicRest-D0snMZXE.js";import{M as W}from"./Modal-BlYbLNMj.js";import{I as o}from"./InputFormGroup-h37C16bz.js";import{S as f}from"./SelectFormGroup-DgCpZP3V.js";import{C as J}from"./CheckboxFormGroup-CKKWUzvp.js";import"./sweetalert2.all-uggxmCrK.js";class K extends U{constructor(){super(...arguments);j(this,"path","business")}}const Q=({id:c,name:r,owner:n,person:m,showLink:w=!0})=>e.createElement("div",{key:`business-${c}`,className:"card mb-0 border",style:{width:"240px",minHeight:"120px"}},e.createElement("div",{className:"card-body"},e.createElement("div",{className:"d-flex align-items-center"},e.createElement("div",{className:"flex-grow-1 overflow-hidden"},e.createElement("h5",{className:"mt-0 mb-1 text-truncate"},e.createElement("i",{className:"fa fa-building me-1"}),r),e.createElement("p",{className:"text-muted mb-1 font-13 text-truncate"},`${n==null?void 0:n.name} ${n==null?void 0:n.lastname}`.trim()||"Sin propietario"),w&&e.createElement(O,{href:`/services?business=${m==null?void 0:m.document_number}`,className:"text-small text-blue"},e.createElement("b",null,"Administrar")))))),V=new K,X=({businesses:c,economic_sectors:r=[],business_activities:n=[],session:m,can:w})=>{a.useRef();const v=a.useRef(),E=a.useRef(),i=a.useRef(),u=a.useRef(),d=a.useRef(),b=a.useRef(),p=a.useRef(),R=a.useRef(),N=a.useRef(),g=a.useRef(),h=a.useRef(),C=a.useRef(),_=a.useRef(),D=a.useRef(),q=a.useRef(),[s,I]=a.useState(!1),[k,M]=a.useState(!1),B=t=>{var l,x,S,A;t!=null&&t.id?I(!0):I(!1),$('[href="#business-data"]').addClass("active"),$('[href="#owner-data"]').removeClass("active"),$("#business-data").addClass("active"),$("#owner-data").removeClass("active"),E.current.value=(t==null?void 0:t.id)||null,$(i.current).val((t==null?void 0:t.economic_sector_id)??null).trigger("change"),$(u.current).val((t==null?void 0:t.business_activity_id)??null).trigger("change"),d.current.value=(t==null?void 0:t.ruc)||null,b.current.value=(t==null?void 0:t.name)||null,p.current.value=(t==null?void 0:t.lastname)||null,$(R.current).val(((l=t==null?void 0:t.owner)==null?void 0:l.document_type)??"DNI").trigger("change"),N.current.value=((x=t==null?void 0:t.owner)==null?void 0:x.document_number)||null,g.current.value=((S=t==null?void 0:t.owner)==null?void 0:S.name)||null,h.current.value=((A=t==null?void 0:t.owner)==null?void 0:A.lastname)||null,$(v.current).modal("show")},F=async t=>{t.preventDefault();const l={id:E.current.value||void 0,economic_sector_id:i.current.value,economic_sector:$(i.current).find("option:selected").text(),business_activity_id:u.current.value,business_activity:$(u.current).find("option:selected").text(),business:{ruc:d.current.value,tradename:b.current.value,businessname:p.current.value},owner:{document_type:R.current.value,document_number:N.current.value,name:g.current.value,lastname:h.current.value}};k?l.contact=l.owner:l.contact={document_type:C.current.value,document_number:_.current.value,name:D.current.value,lastname:q.current.value},await V.save(l)&&$(v.current).modal("hide")},P=async t=>{const l=t.target.value.replace(/\D/g,"");d.current.value=l,l.length<11};return e.createElement(e.Fragment,null,e.createElement("div",{className:"row"},e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"card"},e.createElement("h5",{className:"card-header"},"Mis empresas"),e.createElement("div",{className:"card-body d-flex gap-2 justify-content-center flex-wrap"},e.createElement("div",{key:"business-create",className:"card mb-0 border",style:{width:"240px",minHeight:"120px",cursor:"pointer"},onClick:B},e.createElement("div",{className:"card-body d-flex gap-2 align-items-center justify-content-center flex-column"},e.createElement("i",{className:"fa fa-plus"}),e.createElement("div",null," Crear empresa"))),c.map(t=>e.createElement(Q,{...t}))))),e.createElement("div",{className:"col-md-6"},e.createElement("div",{className:"card"},e.createElement("h5",{className:"card-header"},"Empresas para las que trabajo"),e.createElement("div",{className:"card-body d-flex gap-2 justify-content-center flex-wrap"})))),e.createElement(W,{modalRef:v,title:s?"Editar empresa":"Agregar empresa",onSubmit:F,size:"md"},e.createElement("input",{ref:E,type:"hidden"}),e.createElement("ul",{className:"nav nav-pills navtab-bg nav-justified"},e.createElement("li",{className:"nav-item"},e.createElement(y,{content:"Datos de la empresa"},e.createElement("a",{href:"#business-data","data-bs-toggle":"tab","aria-expanded":"false",className:"nav-link active"},"Empresa"))),e.createElement("li",{className:"nav-item"},e.createElement(y,{content:"Datos del propietario"},e.createElement("a",{href:"#owner-data","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link"},"Propietario"))),e.createElement("li",{className:"nav-item"},e.createElement(y,{content:"Datos del contacto"},e.createElement("a",{href:"#contact-data","data-bs-toggle":"tab","aria-expanded":"true",className:"nav-link"},"Contacto")))),e.createElement("div",{className:"tab-content",style:{minHeight:"230px"}},e.createElement("div",{className:"tab-pane active",id:"business-data"},e.createElement("div",{className:"row"},e.createElement(o,{eRef:d,label:"RUC",col:"col-4",required:!0,onChange:P}),e.createElement(o,{eRef:b,label:"Nombre comercial",col:"col-8",required:!0}),e.createElement(o,{eRef:p,label:"Razon social",col:"col-12",required:!0}),e.createElement(f,{eRef:i,label:"Sector Economico",col:"col-md-5",dropdownParent:"#business-data",required:!0},r.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name))),e.createElement(f,{eRef:u,label:"Actividad comercial",col:"col-md-7",dropdownParent:"#business-data",required:!0},n.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name))))),e.createElement("div",{className:"tab-pane show",id:"owner-data"},e.createElement("div",{className:"row"},e.createElement(f,{eRef:R,label:"Tipo de documento",col:"col-md-6",dropdownParent:"#owner-data",disabled:s,required:!0},e.createElement("option",{value:"DNI"},"DNI - Documento Nacional de Identidad"),e.createElement("option",{value:"CE"},"CE - Carnet de Extranjeria")),e.createElement(o,{eRef:N,label:"Numero de documento",col:"col-md-6",disabled:s,required:!0}),e.createElement(o,{eRef:g,label:"Nombres",col:"col-6",disabled:s,required:!0}),e.createElement(o,{eRef:h,label:"Apellidos",col:"col-6",disabled:s,required:!0}))),e.createElement("div",{className:"tab-pane show",id:"contact-data"},e.createElement("div",{className:"row"},e.createElement("div",{className:"col-12 mb-2"},e.createElement(J,{className:"mx-auto",label:"El propietario es el contacto",title:"Marcar si el propietario y el contacto son la misma persona",style:{maxWidth:"max-content"},onChange:t=>M(t.target.checked)})),!k&&e.createElement(e.Fragment,null,e.createElement(f,{eRef:C,label:"Tipo de documento",col:"col-md-6",dropdownParent:"#contact-data",disabled:s,required:!0},e.createElement("option",{value:"DNI"},"DNI - Documento Nacional de Identidad"),e.createElement("option",{value:"CE"},"CE - Carnet de Extranjeria")),e.createElement(o,{eRef:_,label:"Numero de documento",col:"col-md-6",disabled:s,required:!0}),e.createElement(o,{eRef:D,label:"Nombres",col:"col-6",disabled:s,required:!0}),e.createElement(o,{eRef:q,label:"Apellidos",col:"col-6",disabled:s,required:!0})))))))};z((c,r)=>{L(c).render(e.createElement(H,{...r,title:"Empresas"},e.createElement(X,{...r})))});
